<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sample</title>

    <!-- update the version number as needed -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-app.js"></script> -->
    <!-- include only the Firebase features as you need -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-auth.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-database.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-firestore.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-functions.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-messaging.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-storage.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-analytics.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-remote-config.js"></script> -->
    <!-- <script defer src="/__/firebase/8.1.1/firebase-performance.js"></script> -->
    <!-- 
      initialize the SDK after all desired features are loaded, set useEmulator to false
      to avoid connecting the SDK to running emulators.
    -->
    <!-- <script defer src="/__/firebase/init.js?useEmulator=true"></script> -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="./doDownloadFileByBase64.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-functions.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet" />
    <script>
      let app = firebase.initializeApp({
        apiKey: "AIzaSyALIDKm2EjlndrNAKQ-3_PHQS-uzk4epvw",
        authDomain: "pdfmaker-d4b05.firebaseapp.com",
        projectId: "pdfmaker-d4b05",
      });
    </script>
  </head>
  <body>
    <div id="app">
      <v-app>
        <v-main>
          <v-container>
            <h2>PDFMakerサンプル</h2>
            <input type="button" onClick="onCreatePdf()" value="PDFをダウンロード" />
            <v-img :src="param.p0" alr="サムネイル" width="200" height="200"></v-img>
            <v-file-input
              accept="image/*"
              color="deep-purple accent-4"
              counter
              label="証明写真"
              placeholder="証明写真を撮影、もしくは選択"
              prepend-icon="mdi-camera"
              outlined
              :show-size="1000"
              @change="onImageChange"
            >
              <template v-slot:selection="{ index, text }">
                <v-chip color="deep-purple accent-4" dark label small> {{ text }} </v-chip>
              </template>
            </v-file-input>
            <v-text-field label="p0のラベル" placeholder="p0のプレースホルダー" outlined v-model="param.p0"></v-text-field>
            <v-text-field label="p1のラベル" placeholder="p1のプレースホルダー" outlined v-model="param.p1"></v-text-field>
            <v-text-field label="p2のラベル" placeholder="p2のプレースホルダー" outlined v-model="param.p2"></v-text-field>
            <v-text-field label="p3のラベル" placeholder="p3のプレースホルダー" outlined v-model="param.p3"></v-text-field>
            <v-text-field label="p4のラベル" placeholder="p4のプレースホルダー" outlined v-model="param.p4"></v-text-field>
            <v-text-field label="p5のラベル" placeholder="p5のプレースホルダー" outlined v-model="param.p5"></v-text-field>
            <v-text-field label="p6のラベル" placeholder="p6のプレースホルダー" outlined v-model="param.p6"></v-text-field>
            <v-text-field label="p7のラベル" placeholder="p7のプレースホルダー" outlined v-model="param.p7"></v-text-field>
            <v-text-field label="p8のラベル" placeholder="p8のプレースホルダー" outlined v-model="param.p8"></v-text-field>
            <v-text-field label="p9のラベル" placeholder="p9のプレースホルダー" outlined v-model="param.p9"></v-text-field>
            <v-text-field label="p10のラベル" placeholder="p10のプレースホルダー" outlined v-model="param.p10"></v-text-field>
            <v-text-field label="p11のラベル" placeholder="p11のプレースホルダー" outlined v-model="param.p11"></v-text-field>
            <v-text-field label="p12のラベル" placeholder="p12のプレースホルダー" outlined v-model="param.p12"></v-text-field>
            <v-text-field label="p13のラベル" placeholder="p13のプレースホルダー" outlined v-model="param.p13"></v-text-field>
            <v-text-field label="p14のラベル" placeholder="p14のプレースホルダー" outlined v-model="param.p14"></v-text-field>
            <v-text-field label="p15のラベル" placeholder="p15のプレースホルダー" outlined v-model="param.p15"></v-text-field>
            <v-text-field label="p16のラベル" placeholder="p16のプレースホルダー" outlined v-model="param.p16"></v-text-field>
            <v-text-field label="p17のラベル" placeholder="p17のプレースホルダー" outlined v-model="param.p17"></v-text-field>
            <v-text-field label="p18のラベル" placeholder="p18のプレースホルダー" outlined v-model="param.p18"></v-text-field>
            <v-text-field label="p19のラベル" placeholder="p19のプレースホルダー" outlined v-model="param.p19"></v-text-field>
            <v-text-field label="p20のラベル" placeholder="p20のプレースホルダー" outlined v-model="param.p20"></v-text-field>
            <v-text-field label="p21のラベル" placeholder="p21のプレースホルダー" outlined v-model="param.p21"></v-text-field>
            <v-text-field label="p22のラベル" placeholder="p22のプレースホルダー" outlined v-model="param.p22"></v-text-field>
            <v-text-field label="p23のラベル" placeholder="p23のプレースホルダー" outlined v-model="param.p23"></v-text-field>
            <v-text-field label="p24のラベル" placeholder="p24のプレースホルダー" outlined v-model="param.p24"></v-text-field>
            <v-text-field label="p25のラベル" placeholder="p25のプレースホルダー" outlined v-model="param.p25"></v-text-field>
            <v-text-field label="p26のラベル" placeholder="p26のプレースホルダー" outlined v-model="param.p26"></v-text-field>
            <v-text-field label="p27のラベル" placeholder="p27のプレースホルダー" outlined v-model="param.p27"></v-text-field>
            <v-text-field label="p28のラベル" placeholder="p28のプレースホルダー" outlined v-model="param.p28"></v-text-field>
            <v-text-field label="p29のラベル" placeholder="p29のプレースホルダー" outlined v-model="param.p29"></v-text-field>
            <v-text-field label="p30のラベル" placeholder="p30のプレースホルダー" outlined v-model="param.p30"></v-text-field>
            <v-text-field label="p31のラベル" placeholder="p31のプレースホルダー" outlined v-model="param.p31"></v-text-field>
            <v-text-field label="p32のラベル" placeholder="p32のプレースホルダー" outlined v-model="param.p32"></v-text-field>
            <v-text-field label="p33のラベル" placeholder="p33のプレースホルダー" outlined v-model="param.p33"></v-text-field>
            <v-text-field label="p34のラベル" placeholder="p34のプレースホルダー" outlined v-model="param.p34"></v-text-field>
            <v-text-field label="p35のラベル" placeholder="p35のプレースホルダー" outlined v-model="param.p35"></v-text-field>
            <v-text-field label="p36のラベル" placeholder="p36のプレースホルダー" outlined v-model="param.p36"></v-text-field>
            <v-text-field label="p37のラベル" placeholder="p37のプレースホルダー" outlined v-model="param.p37"></v-text-field>
            <v-text-field label="p38のラベル" placeholder="p38のプレースホルダー" outlined v-model="param.p38"></v-text-field>
            <v-text-field label="p49のラベル" placeholder="p39のプレースホルダー" outlined v-model="param.p39"></v-text-field>
            <v-text-field label="p40のラベル" placeholder="p40のプレースホルダー" outlined v-model="param.p40"></v-text-field>
            <v-text-field label="p41のラベル" placeholder="p41のプレースホルダー" outlined v-model="param.p41"></v-text-field>
            <v-text-field label="p42のラベル" placeholder="p42のプレースホルダー" outlined v-model="param.p42"></v-text-field>
            <v-text-field label="p43のラベル" placeholder="p43のプレースホルダー" outlined v-model="param.p43"></v-text-field>
            <v-text-field label="p44のラベル" placeholder="p44のプレースホルダー" outlined v-model="param.p44"></v-text-field>
            <v-text-field label="p45のラベル" placeholder="p45のプレースホルダー" outlined v-model="param.p45"></v-text-field>
            <v-text-field label="p46のラベル" placeholder="p46のプレースホルダー" outlined v-model="param.p46"></v-text-field>
            <v-text-field label="p47のラベル" placeholder="p47のプレースホルダー" outlined v-model="param.p47"></v-text-field>
            <v-text-field label="p48のラベル" placeholder="p48のプレースホルダー" outlined v-model="param.p48"></v-text-field>
            <v-text-field label="p49のラベル" placeholder="p49のプレースホルダー" outlined v-model="param.p49"></v-text-field>
            <v-text-field label="p50のラベル" placeholder="p50のプレースホルダー" outlined v-model="param.p50"></v-text-field>
            <v-text-field label="p51のラベル" placeholder="p51のプレースホルダー" outlined v-model="param.p51"></v-text-field>
            <v-text-field label="p52のラベル" placeholder="p52のプレースホルダー" outlined v-model="param.p52"></v-text-field>
            <v-text-field label="p53のラベル" placeholder="p53のプレースホルダー" outlined v-model="param.p53"></v-text-field>
            <v-text-field label="p54のラベル" placeholder="p54のプレースホルダー" outlined v-model="param.p54"></v-text-field>
            <v-text-field label="p55のラベル" placeholder="p55のプレースホルダー" outlined v-model="param.p55"></v-text-field>
            <v-text-field label="p56のラベル" placeholder="p56のプレースホルダー" outlined v-model="param.p56"></v-text-field>
            <v-text-field label="p57のラベル" placeholder="p57のプレースホルダー" outlined v-model="param.p57"></v-text-field>
            <v-text-field label="p58のラベル" placeholder="p58のプレースホルダー" outlined v-model="param.p58"></v-text-field>
            <v-text-field label="p59のラベル" placeholder="p59のプレースホルダー" outlined v-model="param.p59"></v-text-field>
            <v-text-field label="p60のラベル" placeholder="p60のプレースホルダー" outlined v-model="param.p60"></v-text-field>
            <v-text-field label="p61のラベル" placeholder="p61のプレースホルダー" outlined v-model="param.p61"></v-text-field>
            <v-text-field label="p62のラベル" placeholder="p62のプレースホルダー" outlined v-model="param.p62"></v-text-field>
            <v-text-field label="p63のラベル" placeholder="p63のプレースホルダー" outlined v-model="param.p63"></v-text-field>
            <v-text-field label="p64のラベル" placeholder="p64のプレースホルダー" outlined v-model="param.p64"></v-text-field>
            <v-text-field label="p65のラベル" placeholder="p65のプレースホルダー" outlined v-model="param.p65"></v-text-field>
            <v-text-field label="p66のラベル" placeholder="p66のプレースホルダー" outlined v-model="param.p66"></v-text-field>
            <v-text-field label="p67のラベル" placeholder="p67のプレースホルダー" outlined v-model="param.p67"></v-text-field>
            <v-text-field label="p68のラベル" placeholder="p68のプレースホルダー" outlined v-model="param.p68"></v-text-field>
            <v-text-field label="p69のラベル" placeholder="p69のプレースホルダー" outlined v-model="param.p69"></v-text-field>
            <v-text-field label="p70のラベル" placeholder="p70のプレースホルダー" outlined v-model="param.p70"></v-text-field>
            <v-text-field label="p71のラベル" placeholder="p71のプレースホルダー" outlined v-model="param.p71"></v-text-field>
            <v-text-field label="p72のラベル" placeholder="p72のプレースホルダー" outlined v-model="param.p72"></v-text-field>
            <v-text-field label="p73のラベル" placeholder="p73のプレースホルダー" outlined v-model="param.p73"></v-text-field>
          </v-container>
        </v-main>
      </v-app>
    </div>
  </body>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script>
    let entity = {
      el: "#app",
      vuetify: new Vuetify(),
      data: {},
      methods: {
        getBase64(file) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = (error) => reject(error);
          });
        },
        onImageChange(file) {
          this.getBase64(file)
            .then((image) => {
              entity.data.param.p0 = image;
            })
            .catch((error) => {
              this.setError(error, "画像の選択に失敗しました。");
            });
        },
      },
    };
    entity.data = {};
    // Initialize Cloud Functions through Firebase
    $.getJSON("rirekisho1.json", (readed) => {
      entity.data = readed;
      new Vue(entity);
    });
    async function onCreatePdf() {
      let pdfMaker = app.functions("asia-northeast1").httpsCallable("pdfMaker");
      try {
        let result = await pdfMaker(entity.data);
        console.log(result.data);
        doDownloadFileByBase64(result.data, "application/pdf", "サンプル.pdf");
      } catch (error) {
        var code = error.code;
        var message = error.message;
        var details = error.details;
        console.error(error);
      }
    }
  </script>
</html>
